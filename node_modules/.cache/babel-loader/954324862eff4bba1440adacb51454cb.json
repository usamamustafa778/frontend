{"ast":null,"code":"import _asyncToGenerator from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/regenerator/index.js\";import axios from'axios';import React,{useContext,useEffect,useReducer,useState}from'react';import Form from'react-bootstrap/Form';import Button from'react-bootstrap/Button';import Container from'react-bootstrap/Container';import{Helmet}from'react-helmet-async';import{useNavigate,useParams}from'react-router-dom';import{toast}from'react-toastify';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import{Store}from'../Store';import{getError}from'../utils';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'FETCH_REQUEST':return _objectSpread(_objectSpread({},state),{},{loading:true});case'FETCH_SUCCESS':return _objectSpread(_objectSpread({},state),{},{loading:false});case'FETCH_FAIL':return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});case'UPDATE_REQUEST':return _objectSpread(_objectSpread({},state),{},{loadingUpdate:true});case'UPDATE_SUCCESS':return _objectSpread(_objectSpread({},state),{},{loadingUpdate:false});case'UPDATE_FAIL':return _objectSpread(_objectSpread({},state),{},{loadingUpdate:false});default:return state;}};export default function UserEditScreen(){var _useReducer=useReducer(reducer,{loading:true,error:''}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,error=_useReducer2$.error,loadingUpdate=_useReducer2$.loadingUpdate,dispatch=_useReducer2[1];var _useContext=useContext(Store),state=_useContext.state;var userInfo=state.userInfo;var params=useParams();var userId=params.id;var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isAdmin=_useState6[0],setIsAdmin=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isSeller=_useState8[0],setIsSeller=_useState8[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:'FETCH_REQUEST'});_context.next=4;return axios.get(\"/api/users/\".concat(userId),{headers:{Authorization:\"Bearer \".concat(userInfo.token)}});case 4:_yield$axios$get=_context.sent;data=_yield$axios$get.data;setName(data.name);setEmail(data.email);setIsAdmin(data.isAdmin);setIsSeller(data.isSeller);dispatch({type:'FETCH_SUCCESS'});_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);dispatch({type:'FETCH_FAIL',payload:getError(_context.t0)});case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[userId,userInfo]);var submitHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.prev=1;dispatch({type:'UPDATE_REQUEST'});_context2.next=5;return axios.put(\"/api/users/\".concat(userId),{_id:userId,name:name,email:email,isAdmin:isAdmin,isSeller:isSeller},{headers:{Authorization:\"Bearer \".concat(userInfo.token)}});case 5:dispatch({type:'UPDATE_SUCCESS'});toast.success('User updated successfully');navigate('/admin/users');_context2.next=14;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);toast.error(getError(_context2.t0));dispatch({type:'UPDATE_FAIL'});case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[1,10]]);}));return function submitHandler(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Container,{className:\"small-container\",children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsxs(\"title\",{children:[\"Edit User $\",userId]})}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Edit User \",userId]}),loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"name\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Name\"}),/*#__PURE__*/_jsx(Form.Control,{value:name,onChange:function onChange(e){return setName(e.target.value);},required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email\"}),/*#__PURE__*/_jsx(Form.Control,{value:email,type:\"email\",onChange:function onChange(e){return setEmail(e.target.value);},required:true})]}),/*#__PURE__*/_jsx(Form.Check,{className:\"mb-3\",type:\"checkbox\",id:\"isAdmin\",label:\"isAdmin\",checked:isAdmin,onChange:function onChange(e){return setIsAdmin(e.target.checked);}}),/*#__PURE__*/_jsx(Form.Check,{className:\"mb-3\",type:\"checkbox\",id:\"isSeller\",label:\"isSeller\",checked:isSeller,onChange:function onChange(e){return setIsSeller(e.target.checked);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Button,{disabled:loadingUpdate,type:\"submit\",children:\"Update\"}),loadingUpdate&&/*#__PURE__*/_jsx(LoadingBox,{})]})]})]});}","map":{"version":3,"names":["axios","React","useContext","useEffect","useReducer","useState","Form","Button","Container","Helmet","useNavigate","useParams","toast","LoadingBox","MessageBox","Store","getError","reducer","state","action","type","loading","error","payload","loadingUpdate","UserEditScreen","dispatch","userInfo","params","userId","id","navigate","name","setName","email","setEmail","isAdmin","setIsAdmin","isSeller","setIsSeller","fetchData","get","headers","Authorization","token","data","submitHandler","e","preventDefault","put","_id","success","target","value","checked"],"sources":["/Users/usamabhatti/Documents/amazona/frontend/src/screens/UserEditScreen.js"],"sourcesContent":["import axios from 'axios';\nimport React, { useContext, useEffect, useReducer, useState } from 'react';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport Container from 'react-bootstrap/Container';\nimport { Helmet } from 'react-helmet-async';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\nimport { Store } from '../Store';\nimport { getError } from '../utils';\n\nconst reducer = (state, action) => {\n    switch (action.type) {\n        case 'FETCH_REQUEST':\n            return { ...state, loading: true };\n        case 'FETCH_SUCCESS':\n            return { ...state, loading: false };\n        case 'FETCH_FAIL':\n            return { ...state, loading: false, error: action.payload };\n        case 'UPDATE_REQUEST':\n            return { ...state, loadingUpdate: true };\n        case 'UPDATE_SUCCESS':\n            return { ...state, loadingUpdate: false };\n        case 'UPDATE_FAIL':\n            return { ...state, loadingUpdate: false };\n        default:\n            return state;\n    }\n};\n\nexport default function UserEditScreen() {\n    const [{ loading, error, loadingUpdate }, dispatch] = useReducer(reducer, {\n        loading: true,\n        error: '',\n    });\n\n    const { state } = useContext(Store);\n    const { userInfo } = state;\n\n    const params = useParams();\n    const { id: userId } = params;\n    const navigate = useNavigate();\n\n    const [name, setName] = useState('');\n    const [email, setEmail] = useState('');\n    const [isAdmin, setIsAdmin] = useState(false);\n    const [isSeller, setIsSeller] = useState(false);\n\n    useEffect(() => {\n        const fetchData = async () => {\n            try {\n                dispatch({ type: 'FETCH_REQUEST' });\n                const { data } = await axios.get(`/api/users/${userId}`, {\n                    headers: { Authorization: `Bearer ${userInfo.token}` },\n                });\n                setName(data.name);\n                setEmail(data.email);\n                setIsAdmin(data.isAdmin);\n                setIsSeller(data.isSeller);\n                dispatch({ type: 'FETCH_SUCCESS' });\n            } catch (err) {\n                dispatch({\n                    type: 'FETCH_FAIL',\n                    payload: getError(err),\n                });\n            }\n        };\n        fetchData();\n    }, [userId, userInfo]);\n\n    const submitHandler = async (e) => {\n        e.preventDefault();\n        try {\n            dispatch({ type: 'UPDATE_REQUEST' });\n            await axios.put(`/api/users/${userId}`,\n                { _id: userId, name, email, isAdmin, isSeller },\n                {\n                    headers: { Authorization: `Bearer ${userInfo.token}` },\n                }\n            );\n            dispatch({\n                type: 'UPDATE_SUCCESS',\n            });\n            toast.success('User updated successfully');\n            navigate('/admin/users');\n        } catch (error) {\n            toast.error(getError(error));\n            dispatch({ type: 'UPDATE_FAIL' });\n        }\n    };\n    return (\n        <Container className=\"small-container\">\n            <Helmet>\n                <title>Edit User ${userId}</title>\n            </Helmet>\n            <h1>Edit User {userId}</h1>\n\n            {loading ? (\n                <LoadingBox />\n            ) : error ? (\n                <MessageBox variant=\"danger\">{error}</MessageBox>\n            ) : (\n                <Form onSubmit={submitHandler}>\n                    <Form.Group className=\"mb-3\" controlId=\"name\">\n                        <Form.Label>Name</Form.Label>\n                        <Form.Control\n                            value={name}\n                            onChange={(e) => setName(e.target.value)}\n                            required\n                        />\n                    </Form.Group>\n                    <Form.Group className=\"mb-3\" controlId=\"email\">\n                        <Form.Label>Email</Form.Label>\n                        <Form.Control\n                            value={email}\n                            type=\"email\"\n                            onChange={(e) => setEmail(e.target.value)}\n                            required\n                        />\n                    </Form.Group>\n\n                    <Form.Check\n                        className=\"mb-3\"\n                        type=\"checkbox\"\n                        id=\"isAdmin\"\n                        label=\"isAdmin\"\n                        checked={isAdmin}\n                        onChange={(e) => setIsAdmin(e.target.checked)}\n                    />\n\n                    <Form.Check\n                        className=\"mb-3\"\n                        type=\"checkbox\"\n                        id=\"isSeller\"\n                        label=\"isSeller\"\n                        checked={isSeller}\n                        onChange={(e) => setIsSeller(e.target.checked)}\n                    />\n\n                    <div className=\"mb-3\">\n                        <Button disabled={loadingUpdate} type=\"submit\">\n                            Update\n                        </Button>\n                        {loadingUpdate && <LoadingBox />}\n                    </div>\n                </Form>\n            )}\n        </Container>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}