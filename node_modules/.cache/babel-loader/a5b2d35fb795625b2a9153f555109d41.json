{"ast":null,"code":"import _objectSpread from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/regenerator/index.js\";import Card from'react-bootstrap/Card';import Button from'react-bootstrap/Button';import{Link}from'react-router-dom';import Rating from'./Rating';import{useContext}from'react';import{Store}from'../Store';import axios from'axios';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Product=function Product(props){var product=props.product;var _useContext=useContext(Store),state=_useContext.state,ctxDispatch=_useContext.dispatch;var cart=state.cart;var addToCartHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(item){var _cart$cartItems;var existItem,quantity,_yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:ctxDispatch({type:'CART_ADD_ITEM_FAIL',payload:''});existItem=(_cart$cartItems=cart.cartItems)===null||_cart$cartItems===void 0?void 0:_cart$cartItems.find(function(x){return x._id===product._id;});quantity=existItem?existItem.quantity+1:1;_context.next=5;return axios.get(\"/api/products/\".concat(item._id));case 5:_yield$axios$get=_context.sent;data=_yield$axios$get.data;if(!(data.countInStock<quantity)){_context.next=10;break;}window.alert('Sorry! Product is out of stock.');return _context.abrupt(\"return\");case 10:if(!(cart.cartItems.length>0&&data.seller._id!==cart.cartItems[0].seller._id)){_context.next=13;break;}ctxDispatch({type:'CART_ADD_ITEM_FAIL',payload:\"Can't Add To Cart \".concat(data.name,\". Buy only from \").concat(cart.cartItems[0].seller.seller.name,\" in this order\")});return _context.abrupt(\"return\");case 13:ctxDispatch({type:'CART_ADD_ITEM',payload:_objectSpread(_objectSpread({},product),{},{quantity:quantity})});case 14:case\"end\":return _context.stop();}}},_callee);}));return function addToCartHandler(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Card,{className:\"product\",children:[/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(product.slug),children:/*#__PURE__*/_jsx(\"img\",{src:product.image,className:\"card-img-top\",alt:product.name})}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(product.slug),children:/*#__PURE__*/_jsx(Card.Title,{children:product.name})}),/*#__PURE__*/_jsx(Rating,{rating:product.rating,numReviews:product.numReviews}),/*#__PURE__*/_jsxs(Row,{className:\"my-2\",children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Card.Text,{children:[\"$\",product.price]})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Link,{to:\"/seller/\".concat(product.seller._id),children:product.seller.seller.name})})]}),product.countInStock===0?/*#__PURE__*/_jsx(Button,{variant:\"light\",disabled:true,children:\"Out of stock\"}):/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return addToCartHandler(product);},children:\"Add to cart\"})]})]},product.slug);};export default Product;","map":{"version":3,"names":["Card","Button","Link","Rating","useContext","Store","axios","Row","Col","Product","props","product","state","ctxDispatch","dispatch","cart","addToCartHandler","item","type","payload","existItem","cartItems","find","x","_id","quantity","get","data","countInStock","window","alert","length","seller","name","slug","image","rating","numReviews","price"],"sources":["/Users/usamabhatti/Documents/amazona/frontend/src/components/Product.js"],"sourcesContent":["import Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport { Link } from 'react-router-dom';\nimport Rating from './Rating';\nimport { useContext } from 'react';\nimport { Store } from '../Store';\nimport axios from 'axios';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\nconst Product = (props) => {\n    const { product } = props;\n\n    const { state, dispatch: ctxDispatch } = useContext(Store);\n    const { cart } = state;\n\n    const addToCartHandler = async (item) => {\n        ctxDispatch({ type: 'CART_ADD_ITEM_FAIL', payload: '' });\n\n        const existItem = cart.cartItems?.find((x => x._id === product._id));\n        const quantity = existItem ? existItem.quantity + 1 : 1;\n\n        const { data } = await axios.get(`/api/products/${item._id}`);\n\n        if (data.countInStock < quantity) {\n            window.alert('Sorry! Product is out of stock.');\n            return;\n        }\n\n        if (cart.cartItems.length > 0 && data.seller._id !== cart.cartItems[0].seller._id) {\n            ctxDispatch({\n                type: 'CART_ADD_ITEM_FAIL',\n                payload: `Can't Add To Cart ${data.name}. Buy only from ${cart.cartItems[0].seller.seller.name} in this order`,\n            });\n            return;\n        }\n\n        ctxDispatch({ type: 'CART_ADD_ITEM', payload: { ...product, quantity } });\n    };\n\n    return (\n        <Card className=\"product\" key={product.slug}>\n            <Link to={`/product/${product.slug}`}>\n                <img src={product.image} className=\"card-img-top\" alt={product.name} />\n            </Link>\n            <Card.Body>\n                <Link to={`/product/${product.slug}`}>\n                    <Card.Title>{product.name}</Card.Title>\n                </Link>\n                <Rating rating={product.rating} numReviews={product.numReviews} />\n                <Row className='my-2'>\n                    <Col>\n                        <Card.Text>${product.price}</Card.Text>\n                    </Col>\n                    <Col>\n                        <Link to={`/seller/${product.seller._id}`}>\n                            {product.seller.seller.name}\n                        </Link>\n                    </Col>\n                </Row>\n                {product.countInStock === 0 ? (\n                    <Button variant=\"light\" disabled>\n                        Out of stock\n                    </Button>\n                ) : (\n                    <Button onClick={() => addToCartHandler(product)}>Add to cart</Button>\n                )}\n            </Card.Body>\n        </Card>\n    );\n};\n\nexport default Product;"],"mappings":"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"},"metadata":{},"sourceType":"module"}