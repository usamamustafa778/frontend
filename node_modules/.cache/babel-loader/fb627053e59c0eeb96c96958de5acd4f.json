{"ast":null,"code":"import _toConsumableArray from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/usamabhatti/Documents/amazona/frontend/node_modules/@babel/runtime/regenerator/index.js\";import axios from'axios';import Chart from'react-google-charts';import React,{useContext,useEffect,useReducer}from'react';import Card from'react-bootstrap/Card';import Col from'react-bootstrap/Col';import Row from'react-bootstrap/Row';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import{Store}from'../Store';import{getError}from'../utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'FETCH_REQUEST':return _objectSpread(_objectSpread({},state),{},{loading:true});case'FETCH_SUCCESS':return _objectSpread(_objectSpread({},state),{},{summary:action.payload,loading:false});case'FETCH_FAIL':return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});default:return state;}};export default function DashboardScreen(){var _useReducer=useReducer(reducer,{loading:true,error:''}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,summary=_useReducer2$.summary,error=_useReducer2$.error,dispatch=_useReducer2[1];var _useContext=useContext(Store),state=_useContext.state;var userInfo=state.userInfo;useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/api/orders/summary',{headers:{Authorization:\"Bearer \".concat(userInfo.token)}});case 3:_yield$axios$get=_context.sent;data=_yield$axios$get.data;dispatch({type:'FETCH_SUCCESS',payload:data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);dispatch({type:'FETCH_FAIL',payload:getError(_context.t0)});case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[userInfo]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Dashboard\"}),loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:summary.users&&summary.users[0]?summary.users[0].numUsers:0}),/*#__PURE__*/_jsx(Card.Text,{children:\" Users\"})]})})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:summary.orders&&summary.users[0]?summary.orders[0].numOrders:0}),/*#__PURE__*/_jsx(Card.Text,{children:\" Orders \"})]})})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(Card.Title,{children:[\"$\",summary.orders&&summary.users[0]?summary.orders[0].totalSales.toFixed(2):0]}),/*#__PURE__*/_jsx(Card.Text,{children:\" Orders \"})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-3\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Sales\"}),summary.dailyOrders.length===0?/*#__PURE__*/_jsx(MessageBox,{children:\"No Sale\"}):/*#__PURE__*/_jsx(Chart,{width:\"100%\",height:\"400px\",chartType:\"AreaChart\",loader:/*#__PURE__*/_jsx(\"div\",{children:\"Loading Chart...\"}),data:[['Date','Sales']].concat(_toConsumableArray(summary.dailyOrders.map(function(x){return[x._id,x.sales];})))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-3\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Categories\"}),summary.productCategories.length===0?/*#__PURE__*/_jsx(MessageBox,{children:\"No Category\"}):/*#__PURE__*/_jsx(Chart,{width:\"100%\",height:\"400px\",chartType:\"PieChart\",loader:/*#__PURE__*/_jsx(\"div\",{children:\"Loading Chart...\"}),data:[['Category','Products']].concat(_toConsumableArray(summary.productCategories.map(function(x){return[x._id,x.count];})))})]})]})]});}","map":{"version":3,"names":["axios","Chart","React","useContext","useEffect","useReducer","Card","Col","Row","LoadingBox","MessageBox","Store","getError","reducer","state","action","type","loading","summary","payload","error","DashboardScreen","dispatch","userInfo","fetchData","get","headers","Authorization","token","data","users","numUsers","orders","numOrders","totalSales","toFixed","dailyOrders","length","map","x","_id","sales","productCategories","count"],"sources":["/Users/usamabhatti/Documents/amazona/frontend/src/screens/DashboardScreen.js"],"sourcesContent":["import axios from 'axios';\nimport Chart from 'react-google-charts';\nimport React, { useContext, useEffect, useReducer } from 'react'\nimport Card from 'react-bootstrap/Card';\nimport Col from 'react-bootstrap/Col';\nimport Row from 'react-bootstrap/Row';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\nimport { Store } from '../Store';\nimport { getError } from '../utils';\n\nconst reducer = (state, action) => {\n    switch (action.type) {\n        case 'FETCH_REQUEST':\n            return { ...state, loading: true };\n        case 'FETCH_SUCCESS':\n            return {\n                ...state,\n                summary: action.payload,\n                loading: false,\n            };\n        case 'FETCH_FAIL':\n            return { ...state, loading: false, error: action.payload };\n\n        default:\n            return state;\n    }\n};\n\nexport default function DashboardScreen() {\n    const [{ loading, summary, error }, dispatch] = useReducer(reducer, {\n        loading: true,\n        error: '',\n    });\n    const { state } = useContext(Store);\n    const { userInfo } = state;\n\n    useEffect(() => {\n        const fetchData = async () => {\n            try {\n                const { data } = await axios.get('/api/orders/summary', {\n                    headers: { Authorization: `Bearer ${userInfo.token}` },\n                });\n\n                dispatch({ type: 'FETCH_SUCCESS', payload: data });\n            } catch (err) {\n                dispatch({\n                    type: 'FETCH_FAIL', payload: getError(err),\n                });\n            }\n        };\n\n        fetchData();\n    }, [userInfo]);\n\n    return (\n        <div>\n            <h1>Dashboard</h1>\n            {loading ? (\n                <LoadingBox />\n            ) : error ? (\n                <MessageBox variant=\"danger\">{error}</MessageBox>\n            ) :\n                <>\n                    <Row>\n                        <Col md={4}>\n                            <Card>\n                                <Card.Body>\n                                    <Card.Title>\n                                        {summary.users && summary.users[0]\n                                            ? summary.users[0].numUsers\n                                            : 0}\n                                    </Card.Title>\n                                    <Card.Text> Users</Card.Text>\n                                </Card.Body>\n                            </Card>\n                        </Col>\n                        <Col md={4}>\n                            <Card>\n                                <Card.Body>\n                                    <Card.Title>\n                                        {summary.orders && summary.users[0]\n                                            ? summary.orders[0].numOrders\n                                            : 0}\n                                    </Card.Title>\n                                    <Card.Text> Orders </Card.Text>\n                                </Card.Body>\n                            </Card>\n                        </Col>\n                        <Col md={4}>\n                            <Card>\n                                <Card.Body>\n                                    <Card.Title>\n                                        $\n                                        {summary.orders && summary.users[0]\n                                            ? summary.orders[0].totalSales.toFixed(2)\n                                            : 0}\n                                    </Card.Title>\n                                    <Card.Text> Orders </Card.Text>\n                                </Card.Body>\n                            </Card>\n                        </Col>\n                    </Row>\n                    <div className=\"my-3\">\n                        <h2>Sales</h2>\n                        {summary.dailyOrders.length === 0 ? (\n                            <MessageBox>No Sale</MessageBox>\n                        ) : (\n                            <Chart\n                                width=\"100%\"\n                                height=\"400px\"\n                                chartType=\"AreaChart\"\n                                loader={<div>Loading Chart...</div>}\n                                data={[\n                                    ['Date', 'Sales'],\n                                    ...summary.dailyOrders.map((x) => [x._id, x.sales]),\n                                ]}\n                            ></Chart>\n                        )}\n                    </div>\n                    <div className=\"my-3\">\n                        <h2>Categories</h2>\n                        {summary.productCategories.length === 0 ? (\n                            <MessageBox>No Category</MessageBox>\n                        ) : (\n                            <Chart\n                                width=\"100%\"\n                                height=\"400px\"\n                                chartType=\"PieChart\"\n                                loader={<div>Loading Chart...</div>}\n                                data={[\n                                    ['Category', 'Products'],\n                                    ...summary.productCategories.map((x) => [x._id, x.count]),\n                                ]}\n                            ></Chart>\n                        )}\n                    </div>\n                </>\n            }\n        </div>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}